<script src="https://tinymce.cachefly.net/4.1/tinymce.min.js"></script>
<script src="/vendor/FileSaver.js"></script>
<script src="/build/html-docx.js"></script>

<script type="text/javascript">
	$(document).ready(function() {
		$("#compose").validate();
		$("#tanggal_sk_pimpinan").datepicker({yearRange:"-10:+10",changeYear:"true",changeMonth:"true",dateFormat:"dd-mm-yy"});
		$("#tanggal_sk_presiden").datepicker({yearRange:"-10:+10",changeYear:"true",changeMonth:"true",dateFormat:"dd-mm-yy"});
		$("#tanggal_ttd").datepicker({yearRange:"-10:+10",changeYear:"true",changeMonth:"true",dateFormat:"dd-mm-yy"});
		/*$.validator.addMethod("time", function(value, element) {
			return this.optional(element) || /^(([0-1]?[0-9])|([2][0-3])):([0-5]?[0-9])$/i.test(value);
		}, "Format waktu salah.");
		$(".timepicker").mask("99:99");*/
		$("table")
			.tablesorter({theme: 'blue', widthFixed: true, widgets: ['zebra', 'filter']})
			.tablesorterPager({container: $(".pager"), 
								output: '{startRow} - {endRow} / {filteredRows} ({totalRows})', 
								fixedHeight: true, 
								removeRows: false, 
								cssGoto: '.gotoPage' });
	});

function selectFields(indeks, id, nomor, nama) 
{
	if(indeks==1){
		$('#no_ketua_rapat').val(nomor);
		$('#nama_ketua_rapat').val(nama);
		$('#id_ketua_rapat').val(id);
	}else if(indeks==2){
		$('#no_sekretaris_rapat').val(nomor);
		$('#nama_sekretaris_rapat').val(nama);
		$('#id_sekretaris_rapat').val(id);
	}
	
	$.facebox.close();
}

function ClearFields(id) 
{
	if(id==1){
		document.getElementById("no_ketua_rapat").value = "";
		document.getElementById("nama_ketua_rapat").value = "";
		document.getElementById("id_ketua_rapat").value = "";
	}else if(id==2){
		document.getElementById("no_sekretaris_rapat").value = "";
		document.getElementById("nama_sekretaris_rapat").value = "";
		document.getElementById("id_sekretaris_rapat").value = "";
	 }
}
</script>

<div class="content-header"></div>
<div class="UI_Header_Title">
	<h1><?=$this->avatar;?>  Edit Catatan Rapat</h1>
	<div class="header_nav_links"><a href="/admin/catatan-rapat">Back to Daftar Catatan Rapat</a></div>
</div>
<div class="clear"></div>
<form id="compose" name="compose" method="post" action="" enctype="multipart/form-data">
	<div class="tabular">
		<p><label>AKD</label><select class="required" id="id_akd" name="id_akd">
			<option value="">-- Pilih AKD --</option>
			<?
			foreach($this->AkdRows as $row)
			{
				$selected = ($this->row->id_akd == $row->id) ? ' selected' : '';
				echo '<option value="' . $row->id . '"' . $selected . '>' . $row->nama . '</option>';
			}
			?>
		</select> <font color="red">*</font></p>
		<p><label>Bidang</label>
		<select class="required" id="bidang" name="bidang">
			<option value="">-- Pilih Bidang --</option>
			<?
			$arrBidang = array(
				'Kerjasama Organisasi Internasional' => 'Kerjasama Organisasi Internasional',
				'Kerjasama Organisasi Regional' => 'Kerjasama Organisasi Regional',
				'Kerjasama Bilateral' => 'Kerjasama Bilateral'
			);
			foreach($arrBidang as $key => $value)
			{
				$selected = ($this->row->bidang == $key) ? ' selected' : '';
				echo '<option value="' . $value . '"' . $selected . '>' . $key . '</option>';
			}
			?>
		</select> <font color="red">*</font>
		<p><label>Tahun Sidang :</label><input type="text" class="required" id="tahun_sidang" autocomplete="disable" name="tahun_sidang" value="<?=$this->row->tahun_sidang;?>" maxlength="4" /> <font color="red">*</font></p>
		<p><label>Masa Persidangan :</label><input type="text" class="required" id="masa_persidangan" autocomplete="disable" name="masa_persidangan" value="<?=$this->row->masa_persidangan;?>" maxlength="4" /> <font color="red">*</font></p>
		<p><label>Rapat Ke :</label><input type="text" class="required" id="rapat_ke" autocomplete="disable" name="rapat_ke" value="<?=$this->row->rapat_ke;?>" maxlength="4" /> <font color="red">*</font></p>		
		<p><label>Jenis Rapat</label>
		<select class="required" id="id_jenis_rapat" name="id_jenis_rapat">
			<option value="">-- Pilih Jenis Rapat --</option>
			<?
			foreach($this->JenisRapatRows as $row)
			{
				$selected = ($this->row->id_jenis_rapat == $row->id) ? ' selected' : '';
				echo '<option value="' . $row->id . '"' . $selected . '>' . $row->nama . '</option>';
			}
			?>
		</select> <font color="red">*</font>
		
		<p><label>Sifat Rapat</label>
		<select class="required" id="sifat_rapat" name="sifat_rapat">
			<option value="">-- Pilih Sifat Rapat --</option>
			<?
			$arrSifatRapat = array(
				'Terbuka' => 'Terbuka',
				'Tertutup' => 'Tertutup'
			);
			foreach($arrSifatRapat as $key => $value)
			{
				$selected = ($this->row->sifat_rapat == $key) ? ' selected' : '';
				echo '<option value="' . $value . '"' . $selected . '>' . $key . '</option>';
			}
			?>
		</select> <font color="red">*</font></p>
		<p><label>Tanggal</label><input readonly type="text" class="datepicker  required" id="tanggal" autocomplete="disable" name="tanggal" value="<?=$this->FormatDate($this->row->tanggal);?>" /> <font color="red">*</font></p>
		<p><label>Waktu</label><input placeholder="23:59" type="text" class="timepicker required" id="waktu" autocomplete="disable" name="waktu" value="<?=$this->row->waktu;?>" /> <font color="red">*</font></p>
		<p><label>Tempat</label><input type="text" class="required" id="tempat" autocomplete="disable" name="tempat" value="<?=$this->row->tempat;?>" /> <font color="red">*</font></p>
		<p><label>Acara</label><input type="text" class="required" id="acara" autocomplete="disable" name="acara" value="<?=$this->row->acara;?>" /> <font color="red">*</font></p>
		
		<?
		$struktur = array(
			'1' => 'HADIR',
			'2' => 'I. PENDAHULUAN',
			'3' => 'II. KESIMPULAN / KEPUTUSAN',
			'4' => 'III. PENUTUP'
		);
		?>
		<p><label><?=$struktur['1'];?></label><a href="/admin/catatan-rapat/add-data/id/<?=$this->row->id;?>/judul/1" class="UIbutton-small">Tambah Data</a></p>
		<p><label><?=$struktur['2'];?></label><a href="/admin/catatan-rapat/add-data/id/<?=$this->row->id;?>/judul/2" class="UIbutton-small">Tambah Data</a></p>
		<p><label><?=$struktur['3'];?></label><a href="/admin/catatan-rapat/add-data/id/<?=$this->row->id;?>/judul/3" class="UIbutton-small">Tambah Data</a></p>
		<p><label><?=$struktur['4'];?></label><a href="/admin/catatan-rapat/add-data/id/<?=$this->row->id;?>/judul/4" class="UIbutton-small">Tambah Data</a></p>

		<p><label>Nama Ketua Rapat</label><input readonly class="" type="text" id="nama_ketua_rapat" autocomplete="disable" name="nama_ketua_rapat" value="<?=$this->row->nama_ketua_rapat;?>"/><input readonly class="" type="hidden" id="no_ketua_rapat" autocomplete="disable" name="no_ketua_rapat" value="<?=$this->row->no_ketua_rapat;?>"/> <input class="" type="hidden" id="id_ketua_rapat" autocomplete="disable" name="id_ketua_rapat" value="<?=$this->row->id_ketua_rapat;?>"/> <input type="button" value="..." id="btnKetuaRapat" onclick="jQuery.facebox({ ajax: '/admin/catatan-rapat/search-ketua-rapat'});"> <input type="button" onclick="ClearFields(1);" value="Clear"></p>

		<p><label>Nama Sekretaris Rapat</label><input readonly class="" type="text" id="nama_sekretaris_rapat" autocomplete="disable" name="nama_sekretaris_rapat" value="<?=$this->row->nama_sekretaris_rapat;?>"/> <input readonly class="" type="hidden" id="no_sekretaris_rapat" autocomplete="disable" name="no_sekretaris_rapat" value="<?=$this->row->no_sekretaris_rapat;?>"/><input class="" type="hidden" id="id_sekretaris_rapat" autocomplete="disable" name="id_sekretaris_rapat" value="<?=$this->row->id_sekretaris_rapat;?>"/> <input type="button" value="..." id="btnSekretarisRapat" onclick="jQuery.facebox({ ajax: '/admin/catatan-rapat/search-sekretaris-rapat'});"> <input type="button" onclick="ClearFields(2);" value="Clear"></p>
		<p>
			<label>File</label>
			<?
			if ($this->row->file_name == "") {
				echo '<input type="file" id="file" autocomplete="disable" name="file"/> <i>(.pdf, max 128 MB)</i>';
			} else {
				echo '<a href="' . $this->url_berkas . '/catatan-rapat/' . $this->row->file_name . '" target="_blank">' . $this->row->file_name . '</a> (' . $this->ByteFormat($this->row->file_size) . ')';				
				if ($this->getRole() == "admin" || $this->getRole() == "super") {
					echo ' [<a href="/admin/catatan-rapat/delete-file/id/' . $this->row->id . '">Delete</a>]';
				} 
			}
			?>		
		</p>

		<p class="savecancel"><label class="UIbutton-small"><input type="submit" value="Simpan" class=""/></label><a href="/admin/catatan-rapat/print/id/<?=$this->row->id;?>" class="UIbutton-small">Cetak</a>&nbsp;<a href="/admin/catatan-rapat" class="UIbutton-small">Batal</a></p>
		<br>
		
		<? if (count($this->rows) > 0) { ?>
			<?=$this->pager;?>

			<table cellspacing="1" cellpadding="6" width="100%" class="tablesorter">
				<thead>
					<tr>
						<th align="center">Judul</th>
						<th align="center">Urutan</th>
						<th align="center">Konten</th>
						<th>&nbsp;</th>
					</tr>
				</thead>
				<tbody>
					<?php
						foreach($this->rows as $row) 
						{
							echo '<tr>';
							echo '<td>' . $struktur[$row->judul] . '</td>';
							echo '<td align="center">' . $row->urutan . '</td>';
							echo '<td>' . strip_tags($row->konten) . '</td>';
							echo '<td align="center"><a href="/admin/catatan-rapat/edit-data/id/'. $row->id .'/id_catatan_rapat/' . $row->id_catatan_rapat . '">EDIT</a>';
							if ($this->getRole() == "admin" || $this->getRole() == "super") {
								echo '<br><a href="/admin/catatan-rapat/delete-data/id/' . $row->id . '/id_catatan_rapat/' . $row->id_catatan_rapat . '" onclick="return confirmDelete();">DELETE</a></td>';
							}
							echo '</tr>';
						}
					?>				
				</tbody>
			</table>
		<? } else {
			echo 'Data tidak ditemukan.';
		} ?>

	</div>
</form>
<div style="clear:both"></div>